<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Lotte & Dieter - Watchlist</title>

    <link href="https://fonts.googleapis.com/css?family=Happy+Monkey" rel="stylesheet">
    <link href="/assets/css/reset.css" rel="stylesheet" type="text/css"/>
    <link crossorigin="anonymous" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
          integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" rel="stylesheet"/>
    <link crossorigin="anonymous" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css"
          integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" rel="stylesheet"/>
    <link href="/assets/css/main.css" rel="stylesheet" type="text/css"/>
    <link href="/assets/css/subpage.css" rel="stylesheet" type="text/css"/>
    <link href="/assets/css/jkanban.css" rel="stylesheet" type="text/css"/>

    <link rel="icon" type="image/jpeg" href="/media/favicon.jpeg">
</head>

<body>
<header id="header">
    <div class="header-titles">
        <h1>Watchlist</h1>
        <h2 th:replace="~{common/couple_counter :: couple_counter}"></h2>
    </div>

    <h2 th:replace="~{common/navbar :: navigation}"></h2>
</header>
<main class="container">
    <div id="watchlist"></div>
    <!--        <div>-->
    <!--            <article>-->
    <!--                <h3>Movies</h3>-->
    <!--                <ul class="editable-list movie-editable-list" data-movie-type="MOVIE">-->
    <!--                    <li th:each="movie: ${movies}" th:data-id="${movie.id}">-->
    <!--                        <span th:text="${movie.name}" />-->
    <!--                        <input type="text" th:value="${movie.name}" autocomplete="off"/>-->
    <!--                    </li>-->
    <!--                    <li data-new="true">-->
    <!--                        <span>add another</span>-->
    <!--                        <input type="text">-->
    <!--                    </li>-->
    <!--                </ul>-->
    <!--            </article>-->
    <!--            <article>-->
    <!--                <h3>Series / Animes</h3>-->
    <!--                <ul class="editable-list movie-editable-list" data-movie-type="SERIE">-->
    <!--                    <li th:each="serie: ${series}" th:data-id="${serie.id}">-->
    <!--                        <span th:text="${serie.name}" />-->
    <!--                        <input type="text" th:value="${serie.name}" autocomplete="off"/>-->
    <!--                    </li>-->
    <!--                    <li data-new="true">-->
    <!--                        <span>add another</span>-->
    <!--                        <input type="text">-->
    <!--                    </li>-->
    <!--                </ul>-->
    <!--            </article>-->
    <!--        </div>-->
</main>
<footer id="footer" th:insert="~{common/footer :: footer}"></footer>

<script src="/assets/js/main.js"></script>
<script src="/assets/js/jkanban.js"></script>

<script>
    const kanban = new jKanban({
        element: '#watchlist',
        gutter: '40px',
        itemAddOptions: {
            enabled: true,
            content: '+',
            class: 'kanban-title-button btn btn-default btn-xs',
            footer: true
        },
        itemHandleOptions: {
            enabled: false,
            handleClass: "item_handle",
            customCssHandler: "drag_handler",
            customCssIconHandler: "drag_handler_icon",
            customHandler: "<span>%title%</span> <i class='fas fa-trash'></i>"
        },
        boards: [
            {
                'id': '_watchlist',
                'title': 'Watch list',
                'class': 'color-pastel-wine-red'
            },
            {
                'id': '_finished',
                'title': 'Finished Watching',
                'class': 'color-pastel-yellow'
            },
            {
                'id': '_awaiting',
                'title': 'Awaiting new movies',
                'class': 'color-pastel-purple'
            }
        ]
    });
</script>

<script type="text/javascript" th:inline="javascript">
    const movies = [];

    /*[# th:each="movie : ${movies}"]*/
    movies.push({
        id: "[(${movie.id})]",
        name: "[(${movie.name})]"
    });
    /*[/]*/

    for (let movie of movies) {
        kanban.addElement(
            "_watchlist",
            {
                "id": movie.id,
                "title": movie.name
            }
        );
    }
</script>

<script type="text/javascript">
    document.querySelector("#watchlist").addEventListener("click", (event) => {
        if (event.target.classList.contains("fa-trash")) {
            const kanbanItem = event.target.parentElement;
            const id = kanbanItem.getAttribute("data-eid");

            // TODO: remove call to backend and only run removeElement on SUCCESS
            kanban.removeElement(id);
        }
    });

    // TODO: on add click, use SweetAlert with textarea input for multi line add of movies <3
</script>

<script crossorigin="anonymous"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script crossorigin="anonymous"
        integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
        src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"></script>
</body>
</html>